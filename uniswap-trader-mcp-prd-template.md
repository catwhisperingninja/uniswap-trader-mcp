# Uniswap Trader MCP - Smithery Configuration PRD Template

## Executive Summary

This Product Requirements Document (PRD) serves as a template for generating the
`smithery.yaml` configuration file for the Uniswap Trader MCP server. The PRD is
generated by analyzing the `index.js` implementation and related configuration
files to identify all required components for proper Smithery deployment.

### Current Status

- **Server**: Uniswap Trader MCP v1.0.0
- **Deployment Type**: Container-based HTTP server
- **Configuration**: Requires `infuraKey` and `walletPrivateKey`
- **Tools**: 2 trading tools, 1 prompt
- **Chains**: 8 blockchain networks supported

---

## 1. Server Analysis

### Server Metadata (Extracted from `index.js`)

```javascript
// From lines 63-68
const server = new McpServer({
	name: "Uniswap Trader MCP",
	version: "1.0.0",
	description:
		"An MCP server for AI agents to automate trading strategies on Uniswap DEX across multiple blockchains",
});
```

**Smithery YAML Mapping:**

```yaml
startCommand:
  type: "http"
  # Server name, version, and description are auto-detected by Smithery
```

---

## 2. Tools Analysis

### Tool 1: `getPrice` (Lines 145-252)

**Description**: Get price quotes for Uniswap swaps with multi-hop routing
**Parameters**:

- `chainId` (number, default: 1) - Chain ID for the blockchain network
- `tokenIn` (string) - Input token address or "NATIVE"
- `tokenOut` (string) - Output token address or "NATIVE"
- `amountIn` (string, optional) - Exact input amount for exactIn trades
- `amountOut` (string, optional) - Exact output amount for exactOut trades
- `tradeType` (enum: "exactIn"|"exactOut", default: "exactIn")

### Tool 2: `executeSwap` (Lines 255-471)

**Description**: Execute swaps on Uniswap with optimal multi-hop routing
**Parameters**:

- `chainId` (number, default: 1) - Chain ID for the blockchain network
- `tokenIn` (string) - Input token address or "NATIVE"
- `tokenOut` (string) - Output token address or "NATIVE"
- `amountIn` (string, optional) - Exact input amount for exactIn trades
- `amountOut` (string, optional) - Exact output amount for exactOut trades
- `tradeType` (enum: "exactIn"|"exactOut", default: "exactIn")
- `slippageTolerance` (number, default: 0.5) - Slippage tolerance in percentage
- `deadline` (number, default: 20) - Transaction deadline in minutes

---

## 3. Prompts Analysis

### Prompt 1: `suggestSwap` (Lines 474-497)

**Description**: Generate swap suggestions with Smart Order Router
**Parameters**:

- `amount` (string) - Amount to swap
- `token` (string) - Starting token address or "NATIVE"
- `tradeType` (enum: "exactIn"|"exactOut", default: "exactIn")

---

## 4. Configuration Requirements

### Required Configuration (Extracted from `index.js` lines 43-60)

```javascript
let currentConfig = {
	infuraKey: process.env.INFURA_KEY,
	walletPrivateKey: process.env.WALLET_PRIVATE_KEY,
};

function ensureConfig() {
	if (!currentConfig.infuraKey) {
		throw new Error("INFURA_KEY is required...");
	}
	if (!currentConfig.walletPrivateKey) {
		throw new Error("WALLET_PRIVATE_KEY is required...");
	}
}
```

**Configuration Schema Requirements:**

- `infuraKey` (string, required): Infura API key for RPC endpoints
- `walletPrivateKey` (string, required): Private key of the wallet for executing
  swaps

---

## 5. Chain Support Analysis

### Supported Chains (Extracted from `chainConfigs.js`)

```javascript
const SUPPORTED_CHAINS = {
	1: "Ethereum",
	10: "Optimism",
	137: "Polygon",
	42161: "Arbitrum One",
	42220: "Celo",
	56: "BNB Chain",
	43114: "Avalanche",
	8453: "Base",
};
```

### Chain Configuration Details:

Each chain requires:

- `rpcUrl`: Infura-based RPC endpoint
- `swapRouter`: Uniswap V3 SwapRouter address
- `poolFactory`: Uniswap V3 Pool Factory address
- `weth`: Wrapped native token address
- `name`: Human-readable chain name

---

## 6. Environment Variables Analysis

### Required Environment Variables:

1. `INFURA_KEY` - Maps to `config.infuraKey`
2. `WALLET_PRIVATE_KEY` - Maps to `config.walletPrivateKey`
3. `PORT` - HTTP server port (defaults to 3000)

### Environment Variable Mapping:

```yaml
env:
  INFURA_KEY: "{{config.infuraKey}}"
  WALLET_PRIVATE_KEY: "{{config.walletPrivateKey}}"
```

---

## 7. HTTP Endpoints Analysis

### MCP Endpoint (`/mcp`) - Lines 526-586

**Methods**: GET, POST, DELETE **Purpose**:

- `GET`: Return server info (name, version, description)
- `POST`: Handle MCP requests (tools, prompts)
- `DELETE`: Handle cleanup

### Health Endpoint (`/health`) - Lines 588-599

**Methods**: GET **Purpose**: Health check endpoint returning server status

### Configuration Handling - Lines 535-548

**Query Parameter Support**:

- `config`: Base64-encoded JSON configuration object
- Individual parameters: `infuraKey`, `walletPrivateKey`

---

## 8. Deployment Requirements

### Runtime Requirements:

- **Type**: Container (Docker-based)
- **Base Image**: `node:lts-alpine`
- **Build Process**: Standard Node.js application build
- **Port**: Environment variable `PORT` (defaults to 3000)

### Docker Requirements:

- Copy `package.json` and `yarn.lock`
- Run `yarn install --frozen-lockfile --production`
- Copy application source code
- Start with `node index.js`

---

## 9. Generated Smithery YAML Configuration

Based on the analysis above, here is the complete `smithery.yaml` configuration:

```yaml
# Smithery configuration file: https://smithery.ai/docs/config#smitheryyaml

runtime: "container"
build:
  dockerfile: "Dockerfile"
  dockerBuildPath: "."
startCommand:
  type: "http"
  configSchema:
    # JSON Schema defining the configuration options for the MCP.
    type: object
    required:
      - infuraKey
      - walletPrivateKey
    properties:
      infuraKey:
        type: string
        description: Infura API key for RPC endpoints
      walletPrivateKey:
        type: string
        description: Private key of the wallet for executing swaps
  exampleConfig:
    infuraKey: abcd1234abcd1234abcd1234abcd1234
    walletPrivateKey: "0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
env:
  INFURA_KEY: "{{config.infuraKey}}"
  WALLET_PRIVATE_KEY: "{{config.walletPrivateKey}}"
```

---

## 10. Validation Checklist

### Pre-Deployment Validation:

- [ ] `index.js` exists and exports MCP server
- [ ] Server implements required HTTP endpoints (`/mcp`, `/health`)
- [ ] Server listens on `PORT` environment variable
- [ ] All required environment variables are mapped
- [ ] Configuration schema matches server requirements
- [ ] Dockerfile builds successfully
- [ ] All tools are properly registered
- [ ] All prompts are properly registered

### Post-Deployment Validation:

- [ ] Server starts successfully in container
- [ ] Health endpoint returns 200 OK
- [ ] MCP endpoint accepts GET/POST/DELETE requests
- [ ] Tools execute without errors
- [ ] Prompts generate expected responses
- [ ] Configuration parameters are properly passed

---

## 11. Automated Generation Template

### Template Variables:

```
SERVER_NAME = Extract from McpServer constructor
SERVER_VERSION = Extract from McpServer constructor
SERVER_DESCRIPTION = Extract from McpServer constructor
REQUIRED_CONFIG = Extract from ensureConfig() function
ENV_VARS = Extract from process.env usage
TOOLS = Extract from server.tool() calls
PROMPTS = Extract from server.prompt() calls
HTTP_ENDPOINTS = Extract from HTTP server setup
CHAIN_SUPPORT = Extract from chainConfigs.js
```

### Generation Algorithm:

1. Parse `index.js` for server metadata
2. Extract tool definitions and schemas
3. Extract prompt definitions and schemas
4. Identify required configuration parameters
5. Map environment variables
6. Generate JSON schema for configSchema
7. Create example configuration
8. Generate complete smithery.yaml

---

## 12. Maintenance and Updates

### When to Regenerate:

- New tools or prompts added
- Configuration requirements change
- New chains added
- Environment variables modified
- HTTP endpoints modified

### Automated Detection:

- Parse `server.tool()` calls for tool schema generation
- Parse `server.prompt()` calls for prompt schema generation
- Analyze `process.env` usage for environment variable mapping
- Extract chain configurations from `chainConfigs.js`
- Validate HTTP endpoint implementations

---

_This PRD template was generated by analyzing the Uniswap Trader MCP `index.js`
implementation and related configuration files. It serves as a comprehensive
guide for generating and maintaining Smithery configuration files for MCP
servers._
